jQuery(document.body).ready(function(a){"use strict";var b;if(a('input[name="edd_options[price_id][]"]').length>0){var c,d,e,f,g,h;if(c=a(".edd_purchase_submit_wrapper").find("a.edd-add-to-cart").attr("class"),!c)return;c=c.replace("edd-add-to-cart",""),h=isMobile.any?edd_free_downloads_vars.mobile_url:"#edd-free-download-modal","1"===edd_free_downloads_vars.has_ajax?(d='<div class="edd-free-downloads-variable-wrapper">',e='<a class="edd-free-downloads-variable edd-free-download '+c+'" href="'+h+'" data-download-id=""><span>',f="</span></a>",g="</div>"):(d="",e='<input type="submit" class="edd-free-downloads-variable edd-free-download '+c+'" name="edd_purchase_download" value="',f='" href="'+h+'" data-download-id="" />',g=""),a(".edd_purchase_submit_wrapper").each(function(b){if("yes"===a(".edd_purchase_submit_wrapper").eq(b).find(".edd-add-to-cart").data("variable-price")){var h=a(this).closest("form").attr("id").replace("edd_purchase_","");if("true"===edd_free_downloads_vars.bypass_logged_in?a(this).after(d+'<a href="#" class="edd-free-downloads-direct-download-link '+c+'" data-download-id="'+h+'">'+edd_free_downloads_vars.download_label+"</a>"+g):a(this).after(d+e+edd_free_downloads_vars.download_label+f+g),a(this).parent().find(".edd-free-downloads-variable").attr("data-download-id",h),"0.00"===a(this).prev().find('input[name="edd_options[price_id][]"]:checked').attr("data-price")){var i=a(this).parent().find(".edd-free-downloads-variable").attr("href"),j=a(this).prev().find('input[name="edd_options[price_id][]"]:checked').val();a(this).css("display","none"),a(this).parent().find(".edd-free-downloads-variable-wrapper").css("display","block"),a(this).parent().find(".edd-free-downloads-variable").attr("href",i+"&download_id="+h+"&price_ids="+j)}else"0.00"===a(this).prev().find('input[name="edd_options[price_id][]"]:checked').attr("data-price")?(a(this).css("display","none"),a(this).parent().find(".edd-free-downloads-variable-wrapper").css("display","block")):(a(this).css("display","block"),a(this).parent().find(".edd-free-downloads-variable-wrapper").css("display","none"))}}),a(document.body).on("change",'input[name="edd_options[price_id][]"]',function(){var b=0,c=0,d=0,e=a(this).closest(".edd_download_purchase_form").find("a.edd-free-downloads-variable").attr("href"),f=a(this).closest(".edd_download_purchase_form").find(".edd_purchase_submit_wrapper").find(".edd-add-to-cart").attr("data-download-id");a(this).closest("ul").find('input[name="edd_options[price_id][]"]').each(function(){a(this).is(":checked")&&(b+=parseFloat(a(this).attr("data-price")),c+=1,d=a(this).val())}),0!==c&&0===b?(a(this).closest(".edd_download_purchase_form").find(".edd_purchase_submit_wrapper").css("display","none"),a(this).closest(".edd_download_purchase_form").find(".edd-free-downloads-variable-wrapper").css("display","block"),a(this).closest(".edd_download_purchase_form").find("a.edd-free-downloads-variable").attr("href",e+"&download_id="+f+"&price_ids="+d)):(a(this).closest(".edd_download_purchase_form").find(".edd_purchase_submit_wrapper").css("display","block"),a(this).closest(".edd_download_purchase_form").find(".edd-free-downloads-variable-wrapper").css("display","none"),a(this).closest(".edd_download_purchase_form").find("a.edd-free-downloads-variable").attr("href",e))}),a(document.body).on("click",".edd-free-downloads-variable",function(a){a.preventDefault()})}isMobile.any?(a(document.body).on("click",".edd-free-download",function(b){b.preventDefault(),a('input[name="edd_free_download_email"]').focus(),a('input[name="edd_free_download_email"]').select(),window.location.href=a(this).attr("href")}),a(document.body).on("click",".edd-free-download-cancel",function(){return parent.history.back(),!1})):(b=new jBox("Modal",{attach:a(".edd-free-download"),content:a("#edd-free-downloads-modal"),width:350,delayClose:3e3,closeButton:edd_free_downloads_vars.close_button,onClose:function(){a(".edd-free-download-submit").removeAttr("disabled"),a(".edd-free-download-submit span").html(edd_free_downloads_vars.modal_download_label),a("div#edd-free-downloads-modal .edd-free-downloads-direct-download-link").length>0&&a("div#edd-free-downloads-modal .edd-free-downloads-direct-download-link").css("display","block")}}),a(document.body).on("click",".edd-free-download",function(c){c.preventDefault();var d=a(this),e=a(this).data("download-id"),f=a(this).html();if(d.append(' <i class="edd-icon-spinner edd-icon-spin"></i>'),"false"===edd_free_downloads_vars.is_download){a(".edd-free-downloads-note-content").html('<div style="text-align:center">'+edd_free_downloads_vars.loading_text+' <i class="edd-icon-spinner edd-icon-spin"></i></div>');var g={action:"edd_free_downloads_get_notes",download_id:e};a.ajax({type:"POST",data:g,dataType:"json",url:edd_free_downloads_vars.ajaxurl,success:function(c){null!==c&&(""!==c.title&&a(".edd-free-downloads-note-title strong").html(c.title),""!==c.content&&a(".edd-free-downloads-note-content").html(c.content)),isMobile.any||b.open(),d.html(f)}}).fail(function(a){window.console&&window.console.log&&console.log(a)})}else d.html(f);a('input[name="edd_free_download_email"]').focus(),a('input[name="edd_free_download_email"]').select(),a('input[name="edd_free_download_id"]').val(e),a(this).parent().parent().find('input[name="edd_options[price_id][]"]').length>0&&(a('input[name="edd_free_download_price_id[]"]').remove(),a(this).parent().parent().find('input[name="edd_options[price_id][]"]').each(function(){(a(this).prop("checked")||"hidden"===a(this).attr("type"))&&a(".edd-free-download-submit").before('<input type="hidden" name="edd_free_download_price_id[]" value="'+a(this).val().toString()+'"/>')}))})),a(document.body).on("keypress",".edd-free-download-field",function(b){return 13===b.which?(a(".edd-free-download-submit").click(),!1):void 0}),a(document.body).on("click",".edd-free-download-submit",function(c){var d,e,f=0;if(a(".edd-free-download-submit").attr("disabled","disabled"),a(".edd-free-downloads-direct-download-link").length>0&&a(".edd-free-downloads-direct-download-link").fadeOut("fast",function(){a(this).css("display","none")}),d=a('input[name="edd_free_download_email"]'),e=/^((([A-Za-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([A-Za-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([A-Za-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([A-Za-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([A-Za-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([A-Za-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([A-Za-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([A-Za-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([A-Za-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([A-Za-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/,""===d.val()?(a("#edd-free-download-error-email-required").css("display","block"),f++):(a("#edd-free-download-error-email-required").css("display","none"),e.test(d.val())?a("#edd-free-download-error-email-invalid").css("display","none"):(a("#edd-free-download-error-email-invalid").css("display","block"),f++)),"true"===edd_free_downloads_vars.require_name){var g,h;g=a('input[name="edd_free_download_fname"]'),h=a('input[name="edd_free_download_lname"]'),""===g.val()?(a("#edd-free-download-error-fname-required").css("display","block"),f++):a("#edd-free-download-error-fname-required").css("display","none"),""===h.val()?(a("#edd-free-download-error-lname-required").css("display","block"),f++):a("#edd-free-download-error-lname-required").css("display","none")}if("true"===edd_free_downloads_vars.user_registration){var i,j,k;i=a('input[name="edd_free_download_username"]'),j=a('input[name="edd_free_download_pass"]'),k=a('input[name="edd_free_download_pass2"]'),""===i.val()?(a("#edd-free-download-error-username-required").css("display","block"),f++):a("#edd-free-download-error-username-required").css("display","none"),""===j.val()?(a("#edd-free-download-error-password-required").css("display","block"),f++):a("#edd-free-download-error-password-required").css("display","none"),""===k.val()?(a("#edd-free-download-error-password2-required").css("display","block"),f++):a("#edd-free-download-error-password2-required").css("display","none"),""!==j.val()&&""!==k.val()&&(j.val()!==k.val()?(a("#edd-free-download-error-password-unmatch").css("display","block"),f++):a("#edd-free-download-error-password-unmatch").css("display","none"))}0===f?(a("#edd_free_download_form").submit(),a(".edd-free-download-submit span").html(edd_free_downloads_vars.download_loading),a(".edd-free-download-submit span").append('<i class="edd-icon-spinner edd-icon-spin"></i>'),a(".edd-free-download-submit").attr("disabled","disabled"),b.close()):(a(".edd-free-download-errors").css("display","block"),a(".edd-free-download-submit").removeAttr("disabled"),c.preventDefault())}),a(document.body).on("click",".edd-free-downloads-direct-download-link",function(c){c.preventDefault(),isMobile.any||b.close();var d="",e=a(this).parent().parent().find('input[name="edd_free_download_id"]').val();if(e||(e=a(this).parent().parent().find(".edd-free-download").data("download-id")),e||(e=a(this).data("download-id")),a(this).parent().parent().find('input[name="edd_free_download_price_id[]"]').length>0&&a(this).parent().parent().find('input[name="edd_free_download_price_id[]"]').each(function(){d+=a(this).val().toString()}),isMobile.any)window.location=window.location+"&edd_action=free_downloads_process_download&download_id="+e+"&price_ids="+d;else{var f=window.location.toString(),g=f.split("?"),h="?";"undefined"!=typeof g[1]&&g[1].length>0&&(h="&"),window.location=window.location+h+"edd_action=free_downloads_process_download&download_id="+e+"&price_ids="+d}})});